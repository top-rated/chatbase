(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{85764:function(e,t,r){let n=r(67294),a=n.forwardRef(function({title:e,titleId:t,...r},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))});e.exports=a},78712:function(e,t,r){let n=r(67294),a=n.forwardRef(function({title:e,titleId:t,...r},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"}))});e.exports=a},45402:function(e,t,r){let n=r(67294),a=n.forwardRef(function({title:e,titleId:t,...r},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"}))});e.exports=a},70759:function(e,t,r){let n=r(67294),a=n.forwardRef(function({title:e,titleId:t,...r},a){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))});e.exports=a},11039:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create-new-chatbot",function(){return r(70527)}])},72483:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(85893),a=r(67294),i=r(84539),o=r(85764),l=r(70759),s=r(78712),u=r(38505);function c(e){let{show:t,setShow:r,variant:c,title:d,description:f,keepOpen:h,keepOpenFor:m=5e3}=e;return(0,a.useEffect)(()=>{if(!t||h)return;let e=setTimeout(()=>r(!1),m);return()=>clearTimeout(e)},[t]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{"aria-live":"assertive",className:"pointer-events-none fixed inset-0 flex items-end px-4 z-20 py-6 sm:items-start sm:p-6",children:(0,n.jsx)("div",{className:"flex w-full flex-col items-center space-y-4 sm:items-end",children:(0,n.jsx)(i.u,{show:t,as:a.Fragment,enter:"transform ease-out duration-300 transition",enterFrom:"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2",enterTo:"translate-y-0 opacity-100 sm:translate-x-0",leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,n.jsx)("div",{className:"pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5",children:(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:"success"===c?(0,n.jsx)(o,{className:"h-6 w-6 text-green-400","aria-hidden":"true"}):"error"===c?(0,n.jsx)(l,{className:"h-6 w-6 text-red-500","aria-hidden":"true"}):(0,n.jsx)(s,{className:"h-6 w-6 text-yellow-500","aria-hidden":"true"})}),(0,n.jsxs)("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:[d&&(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:d}),(0,n.jsx)("p",{className:" text-sm text-gray-500",children:f})]}),(0,n.jsx)("div",{className:"ml-4 flex flex-shrink-0",children:(0,n.jsxs)("button",{type:"button",className:"inline-flex rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2",onClick:()=>{r(!1)},children:[(0,n.jsx)("span",{className:"sr-only",children:"Close"}),(0,n.jsx)(u,{className:"h-5 w-5","aria-hidden":"true"})]})})]})})})})})})})}},70527:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return l}});var n=r(85893),a=r(81639),i=r(84053),o=r(11163),l=!0;t.default=function(){return(0,o.useRouter)(),(0,i.useSupabaseClient)(),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"text-3xl mb-8 text-center font-bold",children:"Data Sources"}),(0,n.jsx)(a.Z,{})]})}},48680:function(e,t,r){"use strict";r.d(t,{Do:function(){return l},Wp:function(){return a},Xx:function(){return n},tL:function(){return i},xK:function(){return o}});let n=/^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/,a="hadsa",i=45e3,o=12e4,l=[".jpeg",".jpg",".png",".gif",".bmp",".mp4",".webm",".ogg",".avi",".mov",".mkv",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".ORF",".CR2"]},29034:function(e,t,r){"use strict";r.d(t,{vc:function(){return w},Gz:function(){return g},rG:function(){return m},dj:function(){return E},Jx:function(){return u},Gv:function(){return b},tf:function(){return d},T3:function(){return c}}),r(99328);var n=r(52285),a=r(8690),i=r(53416),o=r(57542);let l=(0,o.createBrowserSupabaseClient)(),s=async(e,t,r)=>{if(!r.length)return[];let n=[];try{let a=r.map(e=>({blob:new Blob([e.text],{type:"text/plain"}),name:e.name})),o=a.map(r=>{let{blob:a,name:o}=r,l=(0,i.x0)();return n.push(l),e.storage.from("source-files").upload("".concat(null==t?void 0:t.id,"/").concat(l,".txt"),a,{cacheControl:"3600",upsert:!1})}),l=await Promise.all(o),s=l.filter(e=>!e.error);return console.log("Uploaded ".concat(s.length," out of ").concat(a.length," files.")),n}catch(u){return console.error("Bulk upload failed:",u),n}},u=(e,t,r,n)=>{let a=[...e||[],...t];return a&&a.length>0&&0===r.length&&!n?1==a.length?a[0].name:"".concat(a[0].name," + other files"):r.length>0&&0===a.length&&!n?new URL(r[0].url).hostname:n&&0===a.length&&0===r.length?n:"Chatbot ".concat(new Date().toLocaleString())},c=async(e,t,r,n,a,i,o,l,u)=>{if(u&&await m(e,t,u),o.length&&await f(e,i),l.length&&await h(e,i),r.length){let c=await s(e,t,r);await p(e,t,i,c,r)}n.length>0&&await v(e,t,i,n),a.length>0&&await g(e,t,i,a)},d=async(e,t,r,i,o,s,u,c,d,f)=>{let h=e.length+r.text.length+c+t.reduce((e,t)=>e+t.num_of_characters,0)+o.reduce((e,t)=>e+"".concat(t.question,"? ").concat(t.answer).length,0);if(0===h&&0===i.length&&0===o.length)throw Error("Please add your sources");if(0===i.length&&h<100)throw Error("Not enough content.");if(!a.ZP.has((null==s?void 0:s.id)||"")&&h>(0,n.Po)(u))throw Error("Exceeded character limit for your plan. Please upgrade.");if(r.text.length>0&&!d)throw Error("Please add a name for your text source.");if(o.length>0){for(let m of o)if(m.answer.trim().length<2)throw Error("Answer length too short in Q&A section.")}if(f){let p=await x(l),v=(0,n.Sy)(u);if(!a.ZP.has((null==s?void 0:s.id)||"")&&p.length>=v)throw Error("You have reached the limit of ".concat(v," chatbots. Please upgrade your plan."))}let g=await fetch("/api/populate-chatbot-rate-limitter",{method:"POST",headers:{"Content-Type":"application/json"}});if(429===g.status)throw Error("Please allow 2 minutes between trainings")},f=async(e,t)=>{let{error:r}=await e.from("sources").delete().match({chatbot_id:t,type:"link"})},h=async(e,t)=>{let{error:r}=await e.from("sources").delete().match({chatbot_id:t,type:"qna"})},m=async(e,t,r)=>{let{data:n,error:a}=await e.from("sources").delete().match({id:r}).select();if(n){n=n.filter(e=>"file"===e.type);let{data:i,error:o}=await e.storage.from("source-files").remove(n.map(e=>"".concat(null==t?void 0:t.id,"/").concat(e.id,".txt")))}},p=async(e,t,r,n,a)=>{let{data:i,error:o}=await e.from("sources").insert(a.map((e,a)=>({id:n[a],name:e.name,user_id:null==t?void 0:t.id,chatbot_id:r,num_of_characters:e.text.length,type:"file",is_text_input:e.is_text_input})));if(o)throw o;return i},v=async(e,t,r,n)=>{let a=n.map(e=>({id:"link_".concat((0,i.x0)()),name:new URL(e.url).hostname,user_id:null==t?void 0:t.id,chatbot_id:r,num_of_characters:e.size,type:"link",url:e.url,status:"training"})),{data:o,error:l}=await e.from("sources").insert(a);if(l)throw l;return o},g=async(e,t,r,n)=>{let a=n.map(e=>({id:"".concat(e.id),name:e.question,user_id:null==t?void 0:t.id,chatbot_id:r,num_of_characters:"".concat(e.question,"? ").concat(e.answer).length,type:"qna",question:e.question,answer:e.answer})),{data:i,error:o}=await e.from("sources").upsert(a);if(o)throw o;return i},w=async(e,t)=>{let r=(0,i.x0)(),{data:n,error:a}=await e.from("chatbots").insert([{id:r,user_id:t,name:"Untitled",status:"training"}]).select();if(a)throw a;if(!n)throw EvalError("Error creating chatbot in supabase");let o=n[0];return console.log("New chatbot ".concat(name," created and inserted for ").concat(t,".")),o.id},x=async e=>{let{data:{user:t}}=await e.auth.getUser();if(!t)throw EvalError("Error getting user data from supabase");let{data:r,error:n}=await e.from("chatbots").select().eq("user_id",t.id);if(n)throw n;return r},b=async(e,t,r)=>{let n={chatbot_id:t.id};r&&(n.type=r),console.log(n);let{data:a,error:i}=await e.from("sources").select().match(n);if(console.log(a,i),i)throw i;return a},E=async(e,t,r)=>{let{data:n,error:a}=await e.from("chatbots").update({status:r}).eq("id",t).select();if(a)throw a;return n}},84539:function(e,t,r){"use strict";r.d(t,{u:function(){return R}});var n,a=r(67294),i=r(12351),o=r(16567),l=r(32984),s=r(14879),u=r(16723),c=r(3855),d=r(82180),f=r(23784),h=r(9362);function m(e,...t){e&&t.length>0&&e.classList.add(...t)}function p(e,...t){e&&t.length>0&&e.classList.remove(...t)}var v=r(94192),g=r(73781);function w(e=""){return e.split(" ").filter(e=>e.trim().length>1)}let x=(0,a.createContext)(null);x.displayName="TransitionContext";var b=((n=b||{}).Visible="visible",n.Hidden="hidden",n);let E=(0,a.createContext)(null);function y(e){return"children"in e?y(e.children):e.current.filter(({el:e})=>null!==e.current).filter(({state:e})=>"visible"===e).length>0}function _(e,t){let r=(0,c.E)(e),n=(0,a.useRef)([]),o=(0,s.t)(),u=(0,v.G)(),d=(0,g.z)((e,t=i.l4.Hidden)=>{let a=n.current.findIndex(({el:t})=>t===e);-1!==a&&((0,l.E)(t,{[i.l4.Unmount](){n.current.splice(a,1)},[i.l4.Hidden](){n.current[a].state="hidden"}}),u.microTask(()=>{var e;!y(n)&&o.current&&(null==(e=r.current)||e.call(r))}))}),f=(0,g.z)(e=>{let t=n.current.find(({el:t})=>t===e);return t?"visible"!==t.state&&(t.state="visible"):n.current.push({el:e,state:"visible"}),()=>d(e,i.l4.Unmount)}),h=(0,a.useRef)([]),m=(0,a.useRef)(Promise.resolve()),p=(0,a.useRef)({enter:[],leave:[],idle:[]}),w=(0,g.z)((e,r,n)=>{h.current.splice(0),t&&(t.chains.current[r]=t.chains.current[r].filter(([t])=>t!==e)),null==t||t.chains.current[r].push([e,new Promise(e=>{h.current.push(e)})]),null==t||t.chains.current[r].push([e,new Promise(e=>{Promise.all(p.current[r].map(([e,t])=>t)).then(()=>e())})]),"enter"===r?m.current=m.current.then(()=>null==t?void 0:t.wait.current).then(()=>n(r)):n(r)}),x=(0,g.z)((e,t,r)=>{Promise.all(p.current[t].splice(0).map(([e,t])=>t)).then(()=>{var e;null==(e=h.current.shift())||e()}).then(()=>r(t))});return(0,a.useMemo)(()=>({children:n,register:f,unregister:d,onStart:w,onStop:x,wait:m,chains:p}),[f,d,n,w,x,p,m])}function j(){}E.displayName="NestingContext";let k=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function T(e){var t;let r={};for(let n of k)r[n]=null!=(t=e[n])?t:j;return r}let N=i.AN.RenderStrategy,C=(0,i.yV)(function(e,t){var r;let n,{beforeEnter:b,afterEnter:j,beforeLeave:k,afterLeave:C,enter:L,enterFrom:P,enterTo:R,entered:S,leave:F,leaveFrom:z,leaveTo:M,...A}=e,O=(0,a.useRef)(null),Z=(0,f.T)(O,t),B=A.unmount?i.l4.Unmount:i.l4.Hidden,{show:H,appear:U,initial:q}=function(){let e=(0,a.useContext)(x);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[D,G]=(0,a.useState)(H?"visible":"hidden"),V=function(){let e=(0,a.useContext)(E);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:W,unregister:J}=V,X=(0,a.useRef)(null);(0,a.useEffect)(()=>W(O),[W,O]),(0,a.useEffect)(()=>{if(B===i.l4.Hidden&&O.current){if(H&&"visible"!==D){G("visible");return}return(0,l.E)(D,{hidden:()=>J(O),visible:()=>W(O)})}},[D,O,W,J,H,B]);let Y=(0,c.E)({enter:w(L),enterFrom:w(P),enterTo:w(R),entered:w(S),leave:w(F),leaveFrom:w(z),leaveTo:w(M)}),I=(r={beforeEnter:b,afterEnter:j,beforeLeave:k,afterLeave:C},n=(0,a.useRef)(T(r)),(0,a.useEffect)(()=>{n.current=T(r)},[r]),n),K=(0,d.H)();(0,a.useEffect)(()=>{if(K&&"visible"===D&&null===O.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[O,D,K]);let Q=q&&!U,$=!K||Q||X.current===H?"idle":H?"enter":"leave",ee=(0,g.z)(e=>(0,l.E)(e,{enter:()=>I.current.beforeEnter(),leave:()=>I.current.beforeLeave(),idle:()=>{}})),et=(0,g.z)(e=>(0,l.E)(e,{enter:()=>I.current.afterEnter(),leave:()=>I.current.afterLeave(),idle:()=>{}})),er=_(()=>{G("hidden"),J(O)},V);(function({container:e,direction:t,classes:r,onStart:n,onStop:a}){let i=(0,s.t)(),o=(0,v.G)(),d=(0,c.E)(t);(0,u.e)(()=>{let t=(0,h.k)();o.add(t.dispose);let s=e.current;if(s&&"idle"!==d.current&&i.current){var u,c,f,v;let g,w,x,b,E,y,_;return t.dispose(),n.current(d.current),t.add((u=s,c=r.current,f="enter"===d.current,v=()=>{t.dispose(),a.current(d.current)},w=f?"enter":"leave",x=(0,h.k)(),b=void 0!==v?(g={called:!1},(...e)=>{if(!g.called)return g.called=!0,v(...e)}):()=>{},"enter"===w&&(u.removeAttribute("hidden"),u.style.display=""),E=(0,l.E)(w,{enter:()=>c.enter,leave:()=>c.leave}),y=(0,l.E)(w,{enter:()=>c.enterTo,leave:()=>c.leaveTo}),_=(0,l.E)(w,{enter:()=>c.enterFrom,leave:()=>c.leaveFrom}),p(u,...c.enter,...c.enterTo,...c.enterFrom,...c.leave,...c.leaveFrom,...c.leaveTo,...c.entered),m(u,...E,..._),x.nextFrame(()=>{p(u,..._),m(u,...y),function(e,t){let r=(0,h.k)();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:a}=getComputedStyle(e),[i,o]=[n,a].map(e=>{let[t=0]=e.split(",").filter(Boolean).map(e=>e.includes("ms")?parseFloat(e):1e3*parseFloat(e)).sort((e,t)=>t-e);return t});if(i+o!==0){let l=r.addEventListener(e,"transitionend",e=>{e.target===e.currentTarget&&(t(),l())})}else t();r.add(()=>t()),r.dispose}(u,()=>(p(u,...E),m(u,...c.entered),b()))}),x.dispose)),t.dispose}},[t])})({container:O,classes:Y,direction:$,onStart:(0,c.E)(e=>{er.onStart(O,e,ee)}),onStop:(0,c.E)(e=>{er.onStop(O,e,et),"leave"!==e||y(er)||(G("hidden"),J(O))})}),(0,a.useEffect)(()=>{Q&&(B===i.l4.Hidden?X.current=null:X.current=H)},[H,Q,D]);let en=A;return U&&H&&("undefined"==typeof window||"undefined"==typeof document)&&(en={...en,className:function(...e){return e.filter(Boolean).join(" ")}(A.className,...Y.current.enter,...Y.current.enterFrom)}),a.createElement(E.Provider,{value:er},a.createElement(o.up,{value:(0,l.E)(D,{visible:o.ZM.Open,hidden:o.ZM.Closed})},(0,i.sY)({ourProps:{ref:Z},theirProps:en,defaultTag:"div",features:N,visible:"visible"===D,name:"Transition.Child"})))}),L=(0,i.yV)(function(e,t){let{show:r,appear:n=!1,unmount:s,...c}=e,h=(0,a.useRef)(null),m=(0,f.T)(h,t);(0,d.H)();let p=(0,o.oJ)();if(void 0===r&&null!==p&&(r=(0,l.E)(p,{[o.ZM.Open]:!0,[o.ZM.Closed]:!1})),![!0,!1].includes(r))throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[v,g]=(0,a.useState)(r?"visible":"hidden"),w=_(()=>{g("hidden")}),[b,j]=(0,a.useState)(!0),k=(0,a.useRef)([r]);(0,u.e)(()=>{!1!==b&&k.current[k.current.length-1]!==r&&(k.current.push(r),j(!1))},[k,r]);let T=(0,a.useMemo)(()=>({show:r,appear:n,initial:b}),[r,n,b]);(0,a.useEffect)(()=>{if(r)g("visible");else if(y(w)){let e=h.current;if(!e)return;let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&g("hidden")}else g("hidden")},[r,w]);let L={unmount:s};return a.createElement(E.Provider,{value:w},a.createElement(x.Provider,{value:T},(0,i.sY)({ourProps:{...L,as:a.Fragment,children:a.createElement(C,{ref:m,...L,...c})},theirProps:{},defaultTag:a.Fragment,features:N,visible:"visible"===v,name:"Transition"})))}),P=(0,i.yV)(function(e,t){let r=null!==(0,a.useContext)(x),n=null!==(0,o.oJ)();return a.createElement(a.Fragment,null,!r&&n?a.createElement(L,{ref:t,...e}):a.createElement(C,{ref:t,...e}))}),R=Object.assign(L,{Child:P,Root:L})},53416:function(e,t,r){"use strict";r.d(t,{x0:function(){return n}});let n=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")}},function(e){e.O(0,[428,801,639,774,888,179],function(){return e(e.s=11039)}),_N_E=e.O()}]);